<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Circle Button â€” Color Changes with Cursor</title>
  <style>
    :root{
      --size: 140px;
      --bg: #0f172a;
      --fg: #fff;
    }
    html,body{height:100%;}
    body{
      margin:0;
      display:grid;
      place-items:center;
      background: linear-gradient(180deg,var(--bg), #071027 80%);
      font-family:system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:var(--fg);
    }

    .stage{
      display:grid;
      place-items:center;
      gap:20px;
      text-align:center;
    }

    .circle-button{
      width:var(--size);
      height:var(--size);
      border-radius:50%;
      display:grid;
      place-items:center;
      cursor:pointer;
      user-select:none;
      box-shadow: 0 10px 30px rgba(2,6,23,0.6), inset 0 -6px 18px rgba(0,0,0,0.2);
      transition: transform 180ms ease, box-shadow 180ms ease;
      --h: 200;
      --s: 70%;
      --l: 55%;
      background: hsl(var(--h), var(--s), var(--l));
      color:rgba(255,255,255,0.95);
      font-weight:600;
      font-size:18px;
      border: 3px solid rgba(255,255,255,0.06);
    }

    .circle-button:active{ transform: translateY(2px) scale(.99); }
    .circle-button:focus{ outline: none; box-shadow: 0 0 0 6px rgba(100,150,255,0.12); }

    .circle-button::before{
      content:"";
      position:absolute;
      width: calc(var(--size) * 1.6);
      height: calc(var(--size) * 1.6);
      border-radius:50%;
      transform: translate(-50%, -50%);
      left:50%; top:50%;
      pointer-events:none;
      filter: blur(30px) saturate(120%);
      opacity:0.9;
      transition: opacity 200ms ease;
      mix-blend-mode: screen;
      z-index:-1;
      background: radial-gradient(circle at var(--px,50%) var(--py,50%), hsla(var(--h),90%,60%,0.55), transparent 40%);
    }

    .hint{font-size:13px; opacity:0.9}

    @media (prefers-reduced-motion: reduce){
      .circle-button, .circle-button::before{ transition:none; }
    }
  </style>
</head>
<body>
  <div class="stage">
    <button class="circle-button" id="btn" aria-label="Magic color button">Move cursor</button>
    
  </div>

  <script>
    (function(){
      const btn = document.getElementById('btn');

      function handlePointerMove(e){
        const rect = btn.getBoundingClientRect();
        const px = (e.clientX ?? (e.touches && e.touches[0].clientX));
        const py = (e.clientY ?? (e.touches && e.touches[0].clientY));
        if (px == null || py == null) return;

        const cx = rect.left + rect.width/2;
        const cy = rect.top + rect.height/2;
        const dx = px - cx;
        const dy = py - cy;

        let deg = Math.atan2(dy, dx) * 180 / Math.PI;
        deg = (deg + 360) % 360;

        const dist = Math.sqrt(dx*dx + dy*dy);
        const max = Math.hypot(rect.width/2, rect.height/2);
        const n = Math.min(1, dist / max);

        const hue = Math.round(deg);
        const sat = Math.round(60 + n*30);
        const light = Math.round(50 - n*10);

        btn.style.setProperty('--h', hue);
        btn.style.setProperty('--s', sat + '%');
        btn.style.setProperty('--l', light + '%');

        const localX = ((px - rect.left) / rect.width) * 100;
        const localY = ((py - rect.top) / rect.height) * 100;
        btn.style.setProperty('--px', localX + '%');
        btn.style.setProperty('--py', localY + '%');

        btn.style.transform = `translateZ(0) scale(${1 + n*0.03})`;
      }

      function handlePointerLeave(){
        btn.style.transition = 'transform 250ms ease, background 250ms ease';
        btn.style.setProperty('--h', 210);
        btn.style.setProperty('--s', '70%');
        btn.style.setProperty('--l', '55%');
        btn.style.setProperty('--px', '50%');
        btn.style.setProperty('--py', '50%');
        btn.style.transform = '';
        setTimeout(()=> btn.style.transition = '', 260);
      }

      btn.addEventListener('pointermove', handlePointerMove);
      btn.addEventListener('pointerdown', handlePointerMove);
      btn.addEventListener('pointerleave', handlePointerLeave);
      btn.addEventListener('pointercancel', handlePointerLeave);

      window.addEventListener('pointermove', (e)=>{
        const rect = btn.getBoundingClientRect();
        if (e.clientX >= rect.left && e.clientX <= rect.right && e.clientY >= rect.top && e.clientY <= rect.bottom){
          return;
        }
      });

      btn.addEventListener('focus', ()=> btn.style.setProperty('--h', 210));
      btn.addEventListener('keydown', (ev)=>{
        const key = ev.key;
        const cur = parseInt(getComputedStyle(btn).getPropertyValue('--h')) || 210;
        if (key === 'ArrowRight') btn.style.setProperty('--h', (cur + 10) % 360);
        if (key === 'ArrowLeft') btn.style.setProperty('--h', (cur - 10 + 360) % 360);
      });

      handlePointerLeave();

    })();
  </script>
</body>
</html>
